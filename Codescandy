package runner;

import java.io.IOException;
import java.net.MalformedURLException;

import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebElement;
import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;

import utils.Base;
import utils.Reporter;
import utils.Screenshot;
import utils.WebDriverHelper;

public class TestRunner extends Base{
    WebDriverHelper helper;
    ExtentReports reports;
    @BeforeClass
    public void TestCase() {
        helper=new WebDriverHelper(driver);
        reports = Reporter.generateExtentReport("report");
    }
    @BeforeMethod
    public void sample() throws MalformedURLException{
        openBrowser();
    } 

    @Test
    public void sample3() throws IOException, InterruptedException{
        Screenshot.getScreenShot(driver, "img.png");
        WebElement ele = driver.findElement(By.xpath("//*[@id=\"menu-1-683c747a\"]/li[2]/a"));
        JavascriptExecutor js = (JavascriptExecutor)driver;
        js.executeScript("arguments[0].scrollIntoView(true);arguments[0].click();", ele);
        Thread.sleep(3000);
        WebElement ele1 = driver.findElement(By.name("email"));
        JavascriptExecutor js1 = (JavascriptExecutor)driver;
        js1.executeScript("arguments[0].scrollIntoView(true);arguments[0].click();",ele1);
        ele1.sendKeys("admin@gmail.com");
        WebElement ele2 = driver.findElement(By.xpath("//*[@id=\"gumroad-follow-form-embed-button\"]/span/span"));
        ele2.click();
    }  
    @AfterClass
    public void sample1(){
        reports.flush();
    }
    @AfterMethod
    public void sample2(){
        driver.quit();
    }
}















package runner;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URL;
import java.util.Properties;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.remote.RemoteWebDriver;
import org.openqa.selenium.support.events.EventFiringDecorator;
import org.openqa.selenium.support.events.WebDriverListener;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import utils.EventHandler;

public class TestRunner {
    WebDriver driver;
    Properties prop;

    @BeforeMethod
    public void setup() throws Exception
    {
        prop=new Properties();
        FileInputStream fs=new FileInputStream("config/browser.properties");
        prop.load(fs);
        String url=prop.getProperty("url");
        String grdurl=prop.getProperty("gridurl");
        ChromeOptions options=new ChromeOptions();
        driver =new RemoteWebDriver(new URL(grdurl),options);
        driver.manage().window().maximize();
        WebDriverListener lister=new EventHandler();
        driver=new EventFiringDecorator<>(lister).decorate(driver);
        driver.get(url);

    }
    @Test
    public void testcase() throws IOException, InterruptedException
    {
        WebElement about=driver.findElement(By.xpath("(//a[text()='About Us'])[1]"));

        JavascriptExecutor js=(JavascriptExecutor)driver;
        js.executeScript("arguments[0].scrollIntoView(true);arguments[0].click();",about);

        WebElement email=driver.findElement(By.xpath("//input[@name='email']"));
        js.executeScript("arguments[0].scrollIntoView(true);arguments[0].click();",email);
        email.sendKeys("admin@gmail.com");
        Thread.sleep(5000);
        
        WebElement submitBtn = driver.findElement(By.xpath("(//button[@type='submit'])[2]"));
        js.executeScript("arguments[0].scrollIntoView(true); arguments[0].click();", submitBtn);
        Thread.sleep(5000);

        File fs=((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
        File oo=new File("screenshot/img.png");
        FileUtils.copyFile(fs,oo);


    }
    @AfterMethod
    public void teardown()
    {
        if(driver!=null)
        driver.quit();
    }
    
}
