package runner;

import java.io.IOException;
import java.net.URL;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.remote.RemoteWebDriver;
import org.openqa.selenium.support.events.EventFiringDecorator;
import org.openqa.selenium.support.events.WebDriverListener;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;

import utils.EventHandler;
import utils.ExcelReader;
import utils.Screenshot;
import utils.Reporter;

public class TestSample {
   ExtentReports reports;
    public static WebDriver driver;

    @Test
    public void testMain() throws InterruptedException, IOException {
      reports=Reporter.generateExtentReport("test");
            driver = new RemoteWebDriver(new URL("http://localhost:4444"), new ChromeOptions());
            
            // Maximize the browser window
            driver.manage().window().maximize();
                       
            // Add the implicit wait
            driver.manage().timeouts().implicitlyWait(java.time.Duration.ofSeconds(10));
                     
            // Add the page load timeout
            driver.manage().timeouts().pageLoadTimeout(java.time.Duration.ofSeconds(10));
                      
            // Initialize the event listener
            WebDriverListener listener = new EventHandler();
            driver = new EventFiringDecorator<>(listener).decorate(driver);
            String call = ExcelReader.readdata("testdata/Data.xlsx", "sheet1", 0, 0);
            // XSSFWorkbook work=new XSSFWorkbook("testdata/Data.xlsx");
            // Sheet s=work.getSheet("Sheet1");
            // Row r=s.getRow(0);
            // Cell c=r.getCell(0);
            // String val=c.getStringCellValue();
            // Start your script from here
            driver.get("https://practicesoftwaretesting.com/");

            Thread.sleep(7000);
            driver.findElement(By.xpath("//input[@placeholder='Search']")).click();
            Thread.sleep(7000);
            driver.findElement(By.xpath("//input[@placeholder='Search']")).sendKeys(call);
            Thread.sleep(7000);
            driver.findElement(By.xpath("//button[@class='btn btn-secondary']")).click();
            Thread.sleep(7000);

            Screenshot.getScreenShot(driver, "screenshot/img.png");
            driver.quit();
  }
}
