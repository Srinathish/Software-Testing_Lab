'package pages;

import java.io.IOException;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;

import uistore.Ui1;
import utils.ExcelReader;
import utils.LoggerHandler;
import utils.Screenshot;
import utils.WebDriverHelper;

public class Page1 {

        WebDriverHelper helper;
        ExtentTest test;
        WebDriver driver; // only used here for taking screenshot(parameter)

      public Page1(WebDriver driver, ExtentReports reports)
      {
            helper = new WebDriverHelper(driver);
            this.driver = driver;
      }

      public void perforTest()
      {
        try{

            helper.clickOnElement(Ui1.role);
            helper.clickOnElement(Ui1.developer);
            
            String xname = ExcelReader.readdata("testdata/Data.xlsx", "sheet1", 0, 0);
            String xemail = ExcelReader.readdata("testdata/Data.xlsx", "sheet1", 1, 0);
            String xpass = ExcelReader.readdata("testdata/Data.xlsx", "sheet1", 2, 0);
            
            helper.clickOnElement(Ui1.fullname);
            helper.sendKeys(Ui1.fullname, xname);

            helper.clickOnElement(Ui1.email);
            helper.sendKeys(Ui1.email, xemail);

            helper.clickOnElement(Ui1.pass);
            helper.sendKeys(Ui1.pass, xpass);

            helper.clickOnElement(Ui1.conpass);
            helper.sendKeys(Ui1.conpass, xpass);

            helper.clickOnElement(Ui1.applyBtn);

            Screenshot.getScreenShot(driver, "myScreenshot.png");

            LoggerHandler.initLog4j();
            LoggerHandler.logTrace("This is a trace message");
            LoggerHandler.logInfo("This is an info message");
        }
        catch(IOException e)
        {
            e.printStackTrace();
        }
      }
}




package runner;

import java.net.MalformedURLException;

import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.model.Report;

import pages.Page1;
import utils.Base;
import utils.Reporter;

public class TestSample extends Base {

    ExtentReports reports;
    Page1 page1;

    @BeforeClass
    public void generateReport()
    {
        reports = Reporter.generateExtentReport("job report");
    }

    @BeforeMethod
    public void setUp () throws MalformedURLException{
        openBrowser();
        page1 = new Page1(driver,reports);
    }
    
    @Test
    public void testOne() {
        // write or call ur pages here
        page1.perforTest();
    }
    
    @AfterMethod
    public void tearDown() {
        // launch your browser
        if(driver!=null)
        driver.quit();
    }

    @AfterClass
    public void flushreport()
    {
        if(reports!=null)
        reports.flush();

    }
}





package uistore;

import org.openqa.selenium.By;

public class Ui1 {
    
    public static By role  =  By.xpath("//div[contains(text(),'applying')]");
    public static By developer  =  By.xpath("//strong[text()='Developer']");
    public static By fullname  =  By.xpath("//input[@name='fullName']");
    public static By email  =  By.xpath("//input[@name='email']");
    public static By pass  =  By.xpath("//input[@name='password']");
    public static By conpass  =  By.xpath("//input[@name='passwordConfirmation']");
    public static By applyBtn  =  By.xpath("(//button)[3]");
}
